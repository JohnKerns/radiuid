                       ##################################################
                       ##########ReadMe Doc for RadiUID Server###########
                       ##########      Read Me Carefully!     ###########
                       ##################################################
                       ##################################################
                       ##################################################
                       ######       Written by John W Kerns        ######
                       ######      http://blog.packetsar.com       ######
                       ###### https://github.com/PackeTsar/radiuid ######
                       ##################################################
                       ##################################################
                       ##################################################
==================================================================================




##########   VERSION   ##########
-----------------------------------------
The version of RadiUID documented here is:
	v2.0.0




##########   UPDATES IN V1.1.0   ##########
--------------------------------------

**Fixed issue #2: Rewrite push and URL converter to push multiple mappings per REST call.**

Fixed in v1.1.0. The push mechanism will now push up to 100 IP-to-User mappings in each API call and will make as many API calls in a row as necessary to push all collected data from the logs.
This greatly speeds up the push of mappings to the firewall.


**Fixed issue #3: Rewrite "clean_ips" and "clean_names" to use regex instead of static data removal methods.**

Fixed in v1.1.0. This has no tangible effect to an end user, but it is a cleaner method of extracting IP addresses and usernames from the FreeRADIUS logs.


**Fixed issue #5: Issue with complex PAN passwords.**

Fixed in v1.1.0. The program can now accept any password with special characters with the exception of the percent sign (%).


**Fixed issue #6: Documentation of messages made in installer.**

Fixed in v1.1.0. Added comment to installer() method to document the textual cues


**Fixed issue #7: Rewrite log_writer to use global logfile variable.**

Fixed in v1.1.0. kog_writer now only has one input argument and it uses the global logfile var.


**Fixed issue #8: Retest installer utility with all different inputs.**

Fixed in v1.1.0. Tested the utility with different inputs and in different scenarios. Added some error checking for certain situations.



ADDED FEATURES:
     - Added logging of CLI commands to log file for accounting purposes using the cli_log_writer method.




##########   UPDATES IN THIS VERSION   ##########
--------------------------------------
ADDED FEATURES:
     - All code put into classes and used as objects now




##########   WHAT IS RADIUID   ##########
-----------------------------------------

User-based firewall filtering is a novel and attractive concept which can often be difficult to implement due to the requirement by firewalls to map IP addresses to users. One common method of getting user-to-IP mapping information for your firewall is to install a log-reading agent onto an Active Directory domain controller which can look over transaction logs and send the proper information to the firewall, but this assumes user endpoints interact and authenticate directly with the domain controllers, or that you have Active Directory at all!

RadiUID is a Linux-based application built to take everyday RADIUS accounting information generated by RADIUS authenticators like wireless systems, firewalls, etc (which contain username and IP info) and send that ephemeral IP and username mapping info to a Palo Alto firewall to be used by the User-ID system for user or group-based access-list filtering. 




##########   HOW IT WORKS   ##########
--------------------------------------

RadiUID uses FreeRADIUS as a backend service to listen on RADIUS accounting ports (typically TCP\UDP 1813) and write recieved accounting information to accounting logs.

RadiUID then parses these logs, pulls down the User and IP mapping information and pushes those mappings to the Palo Alto firewall using the published RESTful XML API.




##########   REQUIREMENTS   ##########
--------------------------------------

Hopefully this list of requirements will expand as development for RadiUID continues; relaxing the specific requirements for the operating system, interpreter version, and PAN-OS software version; but for the moment these are the requirements for installing and running the RadiUID service.

OS:			**CentOS 7 Minimal Install (recommended to update to latest patches)**

Interpreter:		**Python 2.7.5 (Included in current release of CentOS 7)**

PAN-OS Version:		**6.X and 7.X**




##########   TESTED ENVIRONMENTS   ##########
--------------------------------------

RadiUID has been written and tested in few environments to date as it was purpose-built for a specific environment, but it should be very adaptable as it uses standardized RADIUS accounting to source user information and the published API to push that info to firewalls.

RadiUID has currently been tested with the following RADIUS servers and authenticators

Identity Systems: **JumpCloud RADIUS service, Windows 2012 NPS Server (with Active Directory)**

Authenticators: **Meraki Wireless Access Points, Cisco Wireless (Controller-based)**




##########   INSTALL INSTRUCTIONS   ##########
----------------------------------------------

The install of RadiUID is very quick and straightforward using the built-in installer.
NOTE: You need to be logged in as root or have sudo privileges on the system to install RadiUID

	[1]: Install CentOS 7 Minimal Install with appropriate IP and OS settings


	[2]: Update CentOS 7 to latest patches (recommended)
		> sudo yum update -y

	[3]: Install the Git client (unless you already have the files)
		> sudo yum install git -y

	[4]: Download the RadiUID repo to any location on the box
		> git clone https://github.com/PackeTsar/radiuid.git

	[5]: Change to the directory where the RadiUID main code file (radiuid.py) and config file (radiuid.conf) are stored
		> cd radiuid

	[5.1]: (OPTIONAL) Change to a development branch (perform this step only if you are prepared for a version which is under active development and may have broken features)
		> git checkout dev-X.X.XXX

	[6]: Run the RadiUID program in install mode to perform the install of the service
		> sudo python radiuid.py install

	[7]: Follow the on-screen prompts to install FreeRADIUS and the RadiUID app


	[8]: The installer should let you know if everything installed correctly and services are running, but in the next section are the CLI commands you can run to check up on it.


	[9]: Remember that install mode of RadiUID ('radiuid install') can be used for the initial install and also maintenance of the application:
		-Changing settings in the RadiUID .conf file
		-Changing client settings in FreeRADIUS
		-Checking health of FreeRADIUS and RadiUID services
		----NOTE: Make sure that you have the .conf file in the same directory as the .py directory for the initial install




##########   RADIUID COMMAND INTERFACE   ##########
----------------------------------------------

The RadiUID system is meant to run in the background as a system service: contantly checking for new RADIUS accounting data and pushing User-ID mapping information to the firewall, but it also has an easy to use command interface. This command interface is meant to be used for regular maintenance, troubleshooting, and operation of the system.

Below is the CLI guide for the RadiUID service.

```
Command Syntax from Bash:
	> radiuid [arguments]

===================================== Accepted Arguments =====================================
==============================================================================================
 - run                 |     Run the RadiUID main program in shell mode begin pushing User=ID information
==============================================================================================

 - install             |     Run the RadiUID Install/Maintenance Utility
==============================================================================================

 - show log            |     Show the RadiUID log file
 - show run            |     Show the RadiUID config file
 - show config         |     Show the RadiUID config file
 - show clients        |     Show the FreeRADIUS client config file
 - show status         |     Show the RadiUID and FreeRADIUS service statuses
==============================================================================================

 - tail log            |     Watch the RadiUID log file in real time
==============================================================================================

 - clear log           |     Delete the content in the log file
==============================================================================================

 - edit config         |     Edit the RadiUID config file
 - edit clients        |     Edit list of client IPs for FreeRADIUS
==============================================================================================

 - start radiuid       |     Start the RadiUID system service
 - stop radiuid        |     Stop the RadiUID system service
 - restart radiuid     |     Restart the RadiUID system service
==============================================================================================

 - start freeradius    |     Start the FreeRADIUS system service
 - stop freeradius     |     Stop the FreeRADIUS system service
 - restart freeradius  |     Restart the FreeRADIUS system service
==============================================================================================

 - start all           |     Start the RadiUID and FreeRADIUS system services
 - stop all            |     Stop the RadiUID and FreeRADIUS system services
 - restart all         |     Restart the RadiUID and FreeRADIUS system services
==============================================================================================

 - version             |     Show the current version of RadiUID and FreeRADIUS
==============================================================================================
```




##########   TIMEOUT TUNING   ##########
----------------------------------------------

RadiUID pushes ephemeral User-ID information to the firewall whenever new RADIUS accounting information is recieved and by default sets a timeout of 60 minutes. If this accounting information comes from a wireless system (where most devices re-authenticate regularly) then you may be able to tune down that timeout to make the mapping information expire more quickly. If the RADIUS authenticator is something like a VPN concentrator (where re-authentication doesn't typically happen), then you may want to turn up the timeout period. Either way, you should expect to have to play with the timeout settings to make sure your firewalls are not prematurely expiring User-ID data from their mapping tables.




##########   CONTRIBUTING   ##########
--------------------------------------

If you would like to help out by contributing code or reporting issues, please do!

Visit the GitHub page (https://github.com/PackeTsar/radiuid) and either report an issue or fork the project, commit some changes, and submit a pull request.

